{
	"name": "SQL Script Veiws",
	"properties": {
		"content": {
			"query": "\nCREATE MASTER KEY ENCRYPTION BY PASSWORD = 'Qwerty@321';\n\nCREATE DATABASE SCOPED CREDENTIAL [ADLSCredential]\nWITH IDENTITY = 'Managed Identity';\n\nCREATE EXTERNAL DATA SOURCE [ADLSDataSource]\nWITH (\n    LOCATION = 'https://adlsgen2tokyoolympics.blob.core.windows.net/tokyo-olympics',\n    CREDENTIAL = [ADLSCredential]\n);\n\nSELECT * FROM sys.external_data_sources;\n\nSELECT * FROM sys.database_scoped_credentials;\n\n\n\nALTER  VIEW  [dbo].[athletes_summary] AS\nSELECT *\nFROM OPENROWSET(\n    BULK 'transformed-data/athletes_summary/*.parquet',\n    DATA_SOURCE = [ADLSDataSource],\n    FORMAT = 'PARQUET'\n) AS [result];\n\nALTER VIEW  [dbo].[athletes_with_medals] AS\nSELECT *\nFROM OPENROWSET(\n    BULK 'transformed-data/athletes_with_medals/*.parquet',\n    DATA_SOURCE = ADLSDataSource,\n    FORMAT = 'PARQUET'\n) AS [result];\n\nCREATE OR ALTER VIEW  [dbo].[continent_performance] AS\nSELECT *\nFROM OPENROWSET(\n    BULK 'transformed-data/continent_performance/*.parquet',\n    DATA_SOURCE = [ADLSDataSource],\n    FORMAT = 'PARQUET'\n) AS [result];\n\nCREATE OR ALTER VIEW  [dbo].[country_performance] AS\nSELECT *\nFROM OPENROWSET(\n    BULK 'transformed-data/country_performance/*.parquet',\n    DATA_SOURCE = [ADLSDataSource],\n    FORMAT = 'PARQUET'\n) AS [result];\n\nCREATE OR ALTER VIEW  [dbo].[discipline_gender_medals] AS\nSELECT *\nFROM OPENROWSET(\n    BULK 'transformed-data/discipline_gender_medals/*.parquet',\n    DATA_SOURCE = [ADLSDataSource],\n    FORMAT = 'PARQUET'\n) AS [result];\n\nCREATE OR ALTER VIEW  [dbo].[discipline_medals] AS\nSELECT *\nFROM OPENROWSET(\n    BULK 'transformed-data/discipline_medals/*.parquet',\n    DATA_SOURCE = [ADLSDataSource],\n    FORMAT = 'PARQUET'\n) AS [result];\n\nCREATE OR ALTER VIEW  [dbo].[distinct_athletes] AS\nSELECT *\nFROM OPENROWSET(\n    BULK 'transformed-data/distinct_athletes/*.parquet',\n    DATA_SOURCE = [ADLSDataSource],\n    FORMAT = 'PARQUET'\n) AS [result];\n\nCREATE OR ALTER VIEW  [dbo].[distinct_events] AS\nSELECT *\nFROM OPENROWSET(\n    BULK 'transformed-data/distinct_events/*.parquet',\n    DATA_SOURCE = [ADLSDataSource],\n    FORMAT = 'PARQUET'\n) AS [result];\n\nCREATE OR ALTER VIEW  [dbo].[event_summary] AS\nSELECT *\nFROM OPENROWSET(\n    BULK 'transformed-data/event_summary/*.parquet',\n    DATA_SOURCE = [ADLSDataSource],\n    FORMAT = 'PARQUET'\n) AS [result];\n\nCREATE OR ALTER VIEW  [dbo].[events_summary] AS\nSELECT *\nFROM OPENROWSET(\n    BULK 'transformed-data/events_summary/*.parquet',\n    DATA_SOURCE = [ADLSDataSource],\n    FORMAT = 'PARQUET'\n) AS [result];\n\nCREATE OR ALTER VIEW  [dbo].[gender_summary] AS\nSELECT *\nFROM OPENROWSET(\n    BULK 'transformed-data/gender_summary/*.parquet',\n    DATA_SOURCE = [ADLSDataSource],\n    FORMAT = 'PARQUET'\n) AS [result];\n\nCREATE OR ALTER VIEW  [dbo].[medal_athlete_analysis] AS\nSELECT *\nFROM OPENROWSET(\n    BULK 'transformed-data/medal_athlete_analysis/*.parquet',\n    DATA_SOURCE = [ADLSDataSource],\n    FORMAT = 'PARQUET'\n) AS [result];\n\nCREATE OR ALTER VIEW  [dbo].[medals_summary] AS\nSELECT *\nFROM OPENROWSET(\n    BULK 'transformed-data/medals_summary/*.parquet',\n    DATA_SOURCE = [ADLSDataSource],\n    FORMAT = 'PARQUET'\n) AS [result];\n\nCREATE OR ALTER VIEW  [dbo].[ranked_athletes] AS\nSELECT *\nFROM OPENROWSET(\n    BULK 'transformed-data/ranked_athletes/*.parquet',\n    DATA_SOURCE = [ADLSDataSource],\n    FORMAT = 'PARQUET'\n) AS [result];\n\nCREATE OR ALTER VIEW  [dbo].[ranked_countries] AS\nSELECT *\nFROM OPENROWSET(\n    BULK 'transformed-data/ranked_countries/*.parquet',\n    DATA_SOURCE = [ADLSDataSource],\n    FORMAT = 'PARQUET'\n) AS [result];\n\nCREATE OR ALTER VIEW  [dbo].[ranked_countries_performance] AS\nSELECT *\nFROM OPENROWSET(\n    BULK 'transformed-data/ranked_countries_performance/*.parquet',\n    DATA_SOURCE = [ADLSDataSource],\n    FORMAT = 'PARQUET'\n) AS [result];\n\nCREATE OR ALTER VIEW  [dbo].[ranked_discipline_gender] AS\nSELECT *\nFROM OPENROWSET(\n    BULK 'transformed-data/ranked_discipline_gender/*.parquet',\n    DATA_SOURCE = [ADLSDataSource],\n    FORMAT = 'PARQUET'\n) AS [result];\n\nCREATE OR ALTER VIEW  [dbo].[ranked_disciplines_by_country] AS\nSELECT *\nFROM OPENROWSET(\n    BULK 'transformed-data/ranked_disciplines_by_country/*.parquet',\n    DATA_SOURCE = [ADLSDataSource],\n    FORMAT = 'PARQUET'\n) AS [result];\n\nCREATE OR ALTER VIEW  [dbo].[ranked_event_participation] AS\nSELECT *\nFROM OPENROWSET(\n    BULK 'transformed-data/ranked_event_participation/*.parquet',\n    DATA_SOURCE = [ADLSDataSource],\n    FORMAT = 'PARQUET'\n) AS [result];\n\nCREATE OR ALTER VIEW  [dbo].[ranked_medal_efficiency] AS\nSELECT *\nFROM OPENROWSET(\n    BULK 'transformed-data/ranked_medal_efficiency/*.parquet',\n    DATA_SOURCE = [ADLSDataSource],\n    FORMAT = 'PARQUET'\n) AS [result];\n\nCREATE OR ALTER VIEW  [dbo].[top_10_countries] AS\nSELECT *\nFROM OPENROWSET(\n    BULK 'transformed-data/top_10_countries/*.parquet',\n    DATA_SOURCE = [ADLSDataSource],\n    FORMAT = 'PARQUET'\n) AS [result];\n",
			"metadata": {
				"language": "sql"
			},
			"currentConnection": {
				"databaseName": "tokyo-olympics-db",
				"poolName": "Built-in"
			},
			"resultLimit": 5000
		},
		"type": "SqlQuery"
	}
}